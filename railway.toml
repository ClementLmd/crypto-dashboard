[build]
builder = "DOCKERFILE"
dockerfilePath = ".railway/Dockerfile"

[deploy]
startCommand = "pnpm turbo run start --filter back"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
numReplicas = 1

# Explicitly set environment variables
[deploy.env]
NODE_ENV = "production"
CONNECTION_STRING = "${{Secrets.CONNECTION_STRING}}"
FRONTEND_URL = "${{Secrets.FRONTEND_URL}}"
COOKIE_DOMAIN = "${{Secrets.COOKIE_DOMAIN}}"
BIRDEYE_API_KEY = "${{Secrets.BIRDEYE_API_KEY}}"

[nixpacks]
node_version = "20" 